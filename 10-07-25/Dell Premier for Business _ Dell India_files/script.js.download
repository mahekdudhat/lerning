/*! eric.aguilera 2025/01/14 */
!function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function t(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach((function(e){i(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function r(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function o(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function i(e,t,o){return(t=r(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}
/*! choreograph-create-pixel v1.4.1 2023/02/01 */var n=function(){function e(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.previouslyScrapedHash=null,this.logs=[],this.config=t({colors:{error:"red",warn:"orange",success:"green"},icons:{scraper:"ðŸ“š",viewed:"ðŸ‘€",basketed:"ðŸ›’",purchased:"ðŸ§¾",attribution:"ðŸ”–",conversion:"ðŸ“ˆ"},debug:/(pixel|lemonpi)_debug/i.test(location.href),before:function(e,t){return t(e)},after:function(){},optional:[]},r),this.validateConfig()&&this.cycle()}var r,n,c;return r=e,n=[{key:"log",value:function(e,t){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.config.debug&&!this.logs.includes(t)){var i=["%câ¸¬ create%c ".concat(this.config.icons[this.config.type]," ").concat(this.config.type).concat(this.config.label?" (".concat(this.config.label,")"):""," %c").concat(t),"background:black;color:white;border-radius:3px;padding:3px 6px","font-weight:bold","color:".concat(this.config.colors[e])];o&&i.push(o),(r=console).info.apply(r,i),this.logs.push(t)}}},{key:"validateConfig",value:function(){if("number"!=typeof this.config.advertiser)this.log("error","Please use a number",{advertiser:this.config.advertiser});else if(["scraper","viewed","basketed","purchased","attribution","conversion"].includes(this.config.type))if(["attribution","conversion"].includes(this.config.type)&&"string"!=typeof this.config.label)this.log("error","Please use a string",{label:this.config.label});else if(this.config.url instanceof RegExp){if(["attribution","conversion"].includes(this.config.type)||this.config.scrape)return!0;this.log("error","Please provide something to scrape",{scrape:this.config.scrape})}else this.log("error","Please use a regular expression",{url:this.config.url});else this.log("error","Please use scraper, viewed, basketed, purchased, attribution or conversion",{type:this.config.type})}},{key:"cycle",value:function(){var e=this;if(this.config.url.test(location.href))if("scraper"===this.config.type&&document.querySelector('html[class*="translated-"]'))this.log("warn","This page has been translated by the browser, and won't be scraped");else if(this.config.trigger){var t="create-".concat(this.config.type,"-").concat(this.config.trigger.event);try{var r="string"==typeof this.config.trigger.elements?document.querySelectorAll(this.config.trigger.elements):this.config.trigger.elements();r.forEach||(r=[r]),r.forEach((function(r){r.hasAttribute(t)||(r.addEventListener(e.config.trigger.event,(function(){return"conversion"===e.config.type?e.convert():e.scrape(r)})),r.setAttribute(t,""))}))}catch(e){this.log("error",e.message,{"trigger.elements":this.config.trigger.elements})}}else switch(this.config.type){case"attribution":this.attribute();break;case"conversion":this.convert();break;default:this.scrape()}else this.log("warn",'URL pattern does not match "'.concat(location.href,'"'),{url:this.config.url});setTimeout((function(){return e.cycle()}),750)}},{key:"attribute",value:function(){var e=this.constructor.getQueryParameter("ccpid");if(!e)return this.log("warn","ccpid query parameter not present");if(!/^[0-9a-f]{20}$/.test(e))return this.log("error","ccpid query parameter is not formatted correctly");var t="choreograph-".concat(this.config.label);localStorage.getItem(t)!==e&&localStorage.setItem(t,e),this.log("success","Successful!",e)}},{key:"convert",value:function(){var e=localStorage.getItem("choreograph-".concat(this.config.label));if(!e)return this.log("warn",'"'.concat(this.config.label,'" attribution not present'));this.send(e)}},{key:"scrape",value:function(e){var r,o=this,n=!1,c=function(t,r){var c=t;if("function"==typeof c)try{c=c(e)}catch(e){if(o.config.optional.includes(r))return;o.log("error",e.message,i({},r?"scrape.".concat(r):"scrape",c)),n=!0}return"string"==typeof c&&(c=c.replace(/\s+/g," ").trim()),null!=c&&""!==c||o.config.optional.includes(r)||(o.log("error","Value is empty",i({},r?"scrape.".concat(r):"scrape",c)),n=!0),c};r="scraper"!==this.config.type?c(this.config.scrape):Object.keys(this.config.scrape).reduce((function(e,r){return t(t({},e),{},i({},r,c(o.config.scrape[r],r)))}),{});var a=JSON.stringify(r);if(!n&&this.previouslyScrapedHash!==a){try{this.config.before(r,(function(e){Array.isArray(e)?e.forEach((function(e){return o.send(e)})):o.send(e)}))}catch(e){this.log("error",e.message,{before:this.config.before})}this.previouslyScrapedHash=a,this.logs.length=0}}},{key:"send",value:function(e){var r,o=this;switch(this.config.type){case"scraper":r="https://d.lemonpi.io/scrapes".concat(this.config.debug?"?validate=true":"");break;case"conversion":r="https://content.lemonpi.io/track/event?e=".concat(encodeURIComponent(JSON.stringify({version:1,type:"conversion",name:this.config.label,"conversion-attribution-id":e,"advertiser-id":this.config.advertiser})));break;default:r="https://d.lemonpi.io/a/".concat(this.config.advertiser,"/product/event?e=").concat(encodeURIComponent(JSON.stringify({"event-type":"product-".concat(this.config.type),sku:e})))}"scraper"===this.config.type||this.config.debug?fetch(r,"scraper"===this.config.type?{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({"advertiser-id":this.config.advertiser,sku:e.sku,fields:t(t({},e),{},{sku:void 0})})}:null).then((function(t){return t.json().then((function(r){if(t.ok){o.log("warn","Successful, with warnings. Details:",r);try{o.config.after(e)}catch(e){o.log("error",e.message,{after:o.config.after})}}else o.log("error","Failed: ".concat(t.status," (").concat(t.statusText,"). Details:"),r);o.logs.length=0})).catch((function(){if(t.ok){o.log("success","Successful!",["viewed","basketed","purchased"].includes(o.config.type)?{sku:e}:e);try{o.config.after(e)}catch(e){o.log("error",e.message,{after:o.config.after})}}else o.log("error","Failed: ".concat(t.status," (").concat(t.statusText,"). Details:"),t);o.logs.length=0}))})).catch((function(e){o.log("error","Failed: ".concat(e.message)),o.logs.length=0})):(new Image).src=r}}],c=[{key:"getUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.allowedQueryParameters,r=void 0===t?[]:t,o=e.allowHash,i=void 0!==o&&o,n="".concat(location.protocol,"//").concat(location.host).concat(location.pathname),c=new URLSearchParams(location.search);return r.reduce((function(e,t){var r=e?"&":"?",o=encodeURI(t),i=c.get(t);return null!=i?(n+="".concat(r).concat(o).concat(""===i?"":"=".concat(encodeURI(i))),!0):e}),!1),i&&(n+=location.hash),n}},{key:"getAllPathSegments",value:function(){return location.pathname.split("/").filter((function(e){return e})).map((function(e){return decodeURI(e)}))}},{key:"getPathSegment",value:function(e){return this.getAllPathSegments()[e]}},{key:"getAllQueryParameters",value:function(){return location.search.replace(/^\?/,"").split("&").filter((function(e){return e})).reduce((function(e,r){return t(t({},e),{},i({},decodeURI(r.split("=")[0]),decodeURI(r.split("=")[1]||"")))}),{})}},{key:"getQueryParameter",value:function(e){return this.getAllQueryParameters()[e]}}],n&&o(r.prototype,n),c&&o(r,c),Object.defineProperty(r,"prototype",{writable:!1}),e}(),c=755,a=function(){return n.getPathSegment(0).split("-").reverse().join("_")},s=function(){var e=Array.from(window.dataLayer).reduce((function(e,t){return"view_item"===t[1]&&t[2]&&t[2].items&&t[2].items[0]&&t[2].items[0].id?t[2].items[0].id:("conversion"===t[1]||"purchase"===t[1])&&t[2]&&t[2].u16?t[2].u16:e}),"");if(!e)throw new Error("Not a product page");return"".concat(e,"_").concat(a())};new n({advertiser:c,type:"viewed",url:/dell\.com\/[^/]+\/shop(\/[^/]+){4}|deals\.dell\.com\/[^/]+\/(productdetail|compare)\/[^/]/,scrape:s}),new n({advertiser:c,type:"basketed",url:/(?:www|deals)\.dell\.com\/([a-zA-Z]+(-[a-zA-Z]+)+)\/.*(?:shop|productdetail)\/(?!deals)?.+((?:a|s)pd)?/,trigger:{event:"click",elements:'button.get-deal,button[data-testid="addToCartButton"],button[data-test-id="add-to-cart"],.ps-green,.ps-blue,.btn.btn-success'},scrape:function(e){try{s()}catch(o){var t=e.getAttribute("data-product-data")||e.getAttribute("data-metrics");if(t){var r=JSON.parse(t);return"".concat(r.orderCode||r.productid,"_").concat(a())}}return s()}}),new n({advertiser:c,type:"purchased",url:/(?:www|deals)\.dell\.com\/([a-zA-Z]+(-[a-zA-Z]+))\/buy\/(confirmation\?completedCartId)/,scrape:s}),new n({advertiser:c,type:"scraper",url:/dell\.com\/[^/]+\/shop(\/[^/]+){4}|deals\.dell\.com\/[^/]+\/(productdetail|compare)\/[^/]/,scrape:{sku:s,third_party_review:function(){var e=document.getElementById("product-awards")||document.getElementById("ratings-container");if(!e)return null;var t=e.querySelectorAll("product-awards"===e.id?"div.pt-0.pb-0.p-3":".cfsf-a-cards-wrap > div > div"),r=[],o=["hothardware.com","t3.com","xda-developers.com","windowscentral.com","techradar.com","tomsguide.com","laptopmag.com","tomshardware.com","gamesradar.com","techaeris.com","itpro.co.uk","creativebloq.com","pcgamer.com","storagereview.com","adrenaline.com.br","flowgames.gg","olhardigital.com.br","showmetech.com.br","storagereview.com/pt","tudocelular.com","basic-tutorials.de","channelpartner.de","drwindows.de","gamestar.de","golem.de","igorslab.de","it-business.de","mediennerd.de","storagereview.com/de","global.techradar.com/de-de","techtest.org","testventure.de","computerhoy.com","revistabyte.es","storagereview.com/es","charlestech.fr","clubic.com","time.com"];return t.forEach((function(e){var t=e.querySelector("img"),i="",n=e.querySelector("a").href,c=e.querySelector("a").textContent.trim(),a=e.querySelector("p"),s="";a&&(s=a.textContent.trim().replace(c,"").trim());i=-1!==(i=t&&t.naturalWidth>1&&t.naturalHeight>1?e.querySelector("img").getAttribute("src"):e.querySelector("img").getAttribute("data-src")).indexOf("//i.dell.com")&&-1===i.indexOf("https:")?"https://image.lemonpi.io/img/https:"+i:"https://image.lemonpi.io/img/"+i;var l=o.some((function(e){return n.includes(e)}));""!=i&&""!=c&&""!=s&&l&&r.push({imageUrl:i,title:c,description:s})})),r.length>0?JSON.stringify(r):void 0}}})}();
